---
title : "동기화와(Synchronization)와 교착상태(Deadlock)"
categories : [Computer Science]
tag : [Synchronization, Deadlock]
---


> 💡 동기화와 데드락은 공유 자원을 사용하는 프로세스나 스레드 간의 상호 작용에서 중요한 개념들이다. 동기화를 통해 여러 프로세스나 스레드가 공유 자원을 안전하게 접근하도록 도와주지만, 잘못된 동기화는 데드락을 일으킬 수 있다.



# **동기화 (Synchronization)**

---

## **동기화란?**

여러 프로세스나 스레드가 공유 자원에 동시에 접근할 때 발생할 수 있는 문제를 방지하기 위해 그들 사이의 실행 순서를 조절하는 것을 말한다.

## **동기화의 필요성**

- 여러 프로세스나 스레드가 공유 자원에 동시에 접근할 때 데이터의 일관성을 유지하기 위해 필요하다.
- 동시성 제어 없이 공유 자원을 동시에 변경하면 예기치 않은 결과나 오류가 발생할 수 있다.

## **동기화 기법**

### **1. 임계 구역 (Critical Section)**

- **설명:** 여러 프로세스가 동시에 접근하면 안 되는 공유 자원을 접근하는 코드 부분.
- **예시:** 두 스레드가 동시에 은행 계좌 잔액을 변경할 때 해당 코드 부분.

### **2. 뮤텍스 (Mutex)**

- **설명:** 임계 구역에 하나의 스레드만 들어갈 수 있도록 보장하는 동기화 기법.
- **예시:** 파일을 한 번에 하나의 프로세스만 쓸 수 있도록 제한하는 경우.

### **3. 세마포어 (Semaphore)**

- **설명:** 동시에 접근할 수 있는 스레드나 프로세스의 최대 허용 수를 제한하는 동기화 기법.
- **예시:** 동시에 3개의 스레드만 데이터베이스에 쓸 수 있도록 제한하는 경우.

### **4. 모니터 (Monitor)**

- **설명:** 뮤텍스와 조건 변수를 결합하여 임계 구역을 보호하는 높은 수준의 동기화 기법.
- **예시:** 한 스레드가 데이터를 추가하면 다른 스레드가 그 데이터를 처리하는 경우.

## **레이스 컨디션 (Race Condition)**

- **설명:** 두 개 이상의 스레드가 공유 자원을 동시에 변경하려고 할 때 발생하는 상황.
- **예시:** 두 스레드가 동시에 은행 계좌 잔액을 조회하고 변경할 때 잔액이 잘못된 값으로 설정되는 경우.

동기화는 복잡한 환경에서 여러 프로세스나 스레드가 원활하게 작동하도록 하는 중요한 개념이다. 잘못된 동기화는 시스템 성능 저하나 데이터 손실과 같은 큰 문제를 일으킬 수 있다.


<br><br>


# 교착상태 (Deadlock)

---

## **교착상태란?**

여러 개의 프로세스나 스레드가 서로를 기다리며 무한히 대기하는 상황을 뜻한다.

## **교착상태의 조건**

교착상태의 발생에는 다음의 4가지 필요 충분 조건이 있다

### **1. 상호배제 (Mutual Exclusion)**

- **설명**: 한 번에 한 프로세스만이 특정 자원을 사용할 수 있다.
- **예시**: 프린터는 한 번에 하나의 작업만 처리할 수 있습니다. 따라서 두 개의 프로세스가 동시에 프린터를 사용하려고 시도하면 상호배제 조건이 위반된다.

### **2. 점유와 대기 (Hold and Wait)**

- **설명**: 프로세스가 이미 어떤 자원을 보유하고 있으면서 다른 자원을 기다릴 때 발생한다.
- **예시**: 프로세스 A가 파일을 보유하면서 프린터를 기다리고, 프로세스 B가 그 프린터를 보유하면서 해당 파일을 기다리는 상황.

### **3. 비선점 (No Preemption)**

- **설명**: 자원이 한 프로세스에 의해 점유되어 있을 때, 다른 프로세스가 그 자원을 강제로 뺏어오지 못한다.
- **예시**: 프로세스 A가 데이터베이스 연결을 사용 중일 때, 프로세스 B는 A로부터 그 연결을 강제로 가져올 수 없다.

### **4. 환형 대기 (Circular Wait)**

- **설명**: 각 프로세스는 순차적으로 다음 프로세스가 요청한 자원을 보유하고 있다.
- **예시**: 프로세스 A는 메모리를 보유하면서 디스크를 기다리고, 프로세스 B는 디스크를 보유하면서 네트워크 연결을 기다리고, 프로세스 C는 네트워크 연결을 보유하면서 메모리를 기다리는 상황.

이 네 가지 조건 중 어느 하나라도 만족되지 않으면 교착상태는 발생하지 않는다.

## **교착상태 해결 방법**

### 1. **예방 (Deadlock Prevention)**

- **설명:** 교착상태의 4가지 조건 중 하나 이상을 무효화시켜 교착상태가 발생하지 않도록 하는 방법
- **예시:**
    - 상호배제: 이 조건을 제거하기 위해 프린터와 같은 공유 자원에 대해 동시 접근을 허용하는 방식으로 디자인할 수 있습니다. 하지만, 이는 자원의 특성에 따라 불가능할 수도 있다.
    - 점유와 대기: 프로세스가 실행되기 전에 모든 필요한 자원을 한 번에 요청하도록 하여 이 조건을 제거할 수 있다.
    - 환형 대기: 자원에 순번을 부여하고, 프로세스가 순서대로 자원을 요청하도록 함으로써 이 조건을 제거할 수 있다.

### 2. **회피 (Deadlock Avoidance)**

- **설명:** 시스템의 상태를 검사하여 교착상태가 발생할 가능성이 있을 때 해당 작업을 거부하는 방법
- **예시:**
    - **Banker's Algorithm**: 각 프로세스가 필요로 하는 최대 자원을 미리 알려주고, 시스템은 안전한 상태를 유지하기 위해 자원 할당 여부를 결정한다.

### 3. **탐지 및 복구 (Deadlock Detection & Recovery)**

- **설명:** 교착상태가 발생했는지 시스템을 주기적으로 확인하고, 발견될 경우 복구하는 방법
- **예시:**
    - **자원 할당 그래프**: 주기적으로 그래프를 확인하여 사이클이 발생하는지 검사합니다. 사이클이 발견되면 교착상태가 발생한 것으로 간주한다.
    - **복구 방법**: 교착상태에 있는 프로세스를 종료하거나, 프로세스로부터 자원을 강제로 회수하여 교착상태를 해결한다.

### 4. **무시 (Deadlock Ignorance)**

- **설명:** 교착상태가 발생할 확률이 매우 낮다고 가정하고, 특별한 조치를 취하지 않는 방법
- **예시:** 대부분의 운영체제는 교착상태가 발생할 확률이 낮다고 가정한다. 따라서 대부분의 경우 운영체제는 교착상태를 무시한다. 사용자는 문제가 발생할 경우 시스템을 재시작하거나 해당 프로세스를 수동으로 종료하여 문제를 해결한다.

각 방법마다 장단점이 있으므로, 시스템의 특성과 요구사항에 따라 적절한 방법을 선택해야 한다.

<br><br>

# **동기화와 데드락**

---

## **동기화와 데드락의 관계**

동기화는 여러 프로세스나 스레드가 공유 자원에 안전하게 접근할 수 있도록 도와주는 기법이다. 하지만, 동기화를 잘못 구현하면 데드락이 발생할 수 있다. 예를 들어, 두 프로세스가 서로 다른 뮤텍스를 잡고, 서로의 뮤텍스를 기다리는 상황이 발생하면 데드락이 발생한다.

## **동기화 기법과 데드락**

### **1. 임계 구역 (Critical Section)**

- 데드락 위험: 임계 구역을 보호하기 위한 동기화 메커니즘이 잘못 구현되면 데드락 위험이 있다.

### **2. 뮤텍스 (Mutex)**

- 데드락 위험: 두 스레드나 프로세스가 서로의 뮤텍스를 기다리는 상황에서 데드락이 발생할 수 있다.

### **3. 세마포어 (Semaphore)**

- 데드락 위험: 여러 세마포어를 사용할 때, 프로세스들이 서로 다른 순서로 세마포어를 요청하면 데드락이 발생할 수 있다.

### **4. 모니터 (Monitor)**

- 데드락 위험: 모니터 내에서 여러 조건 변수를 사용하면서 잘못된 순서로 대기하게 되면 데드락이 발생할 수 있다.

## **동기화를 통한 데드락 해결**

동기화 기법 중 하나인 뮤텍스와 세마포어를 활용하여 데드락을 예방할 수 있다. 예를 들어, 여러 뮤텍스를 사용할 때 항상 일정한 순서로 뮤텍스를 획득하도록 설계하면 환형 대기 조건을 무효화시켜 데드락을 예방할 수 있습니다.



<br>

---
> 💡 동기화와 데드락은 서로 밀접한 관계가 있으며, 동기화를 통해 시스템의 동시성을 보장하면서도 데드락을 예방하거나 회피하는 것이 중요하다.

<br>
